#!/bin/sh
set -e

THIS=/usr/sbin/update-xpdf-poppler-rc
DIR=/etc/xpdf-poppler
TARGET=${DIR}/includes

if [ \! -d ${DIR} ]; then
    mkdir ${DIR}
fi

# Generate ${DIR}/includes from ${DIR}/*
# This allows the xpdf-poppler-* language add-on packages
# to supply configuration file snippets.

cat >> ${TARGET} <<EOF
# DO NOT EDIT THIS FILE DIRECTLY.
# This file was automatically generated by ${THIS}.
# Instead, add or remove files in ${DIR}/ then run
# ${THIS} to regenerate this file.

EOF

# get shell interpreted * to drop .svn etc.

find -L ${DIR}/* \
    -name xpdf-poppler-rc-\* \
    -and -type f \
    -and -not -name \*.dpkg\* \
    -and -not -name \*~ \
    -and -not -name \*,v \
    -printf "include %p\n" >> ${TARGET}
